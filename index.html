<!DOCTYPE html>
<html lang="ko">
<title>ë‚˜ì˜ íƒ€ê³ ë‚œ ìì—°ì˜ ëª¨ìŠµì€?</title>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <meta property="og:url" content="https://earlyway.github.io/" />
    <meta property="og:title" content="ë‚˜ì˜ íƒ€ê³ ë‚œ ìì—°ì˜ ëª¨ìŠµì€?1" />
    <meta property="og:description" content="ìƒë…„ì›”ì¼ë¡œ ì•Œì•„ë³´ëŠ” ë‚˜ì˜ íƒ€ê³ ë‚œ ì„±í–¥ í…ŒìŠ¤íŠ¸1" />
    <meta property="og:image" content="https://ibb.co/HtQkBTH" />
    <!--ê¸€ì”¨ì²´-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Jua&family=Noto+Sans+KR&display=swap" rel="stylesheet">
    <!--íŒŒë¹„ì½˜ appres.org-->
    <link rel="icon" type="image/png" href="/image/favicon_.png" />
    <!--cssíŒŒì¼ ì—°ê²°-->
    <link rel="stylesheet" type="text/css" href="inputstyle.css">
    <!-- ì¹´ì¹´ì˜¤í†¡ ê³µìœ í•˜ê¸°-->
    <script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
    <script>
        Kakao.init('5bb339cadb6a8c53105514b7e3df11c2');

    </script>
</head>


<body>
    <div class="backback">
        <!-- íƒ€ì´í‹€ê³¼ ì‚¬ì§„ ì˜ì—­ -->
        <div class="flexbox" style="position: relative;">
            <img src="/image/main_img.jpg" alt="Main_Image">
        </div>




        <!-- ì¤‘ê°„ ë¬¸ì¥ê³¼ ì¸í’‹ ì˜ì—­ -->
        <div class="textmid1">
            <h3>í˜„ì¬ 
                <span id="api-count">
                </span> ëª…ì´ ì°¸ì—¬í–ˆì–´ìš”!
            </h3>
        </div>
        <div class="textmid2">ìƒë…„ì›”ì¼ë¡œ ì•Œì•„ë³´ëŠ” ë‚˜ì˜ íƒ€ê³ ë‚œ ì„±í–¥ í…ŒìŠ¤íŠ¸
        </div>
        <form name="join_form" action="" accept-charset="utf-8" method="get">
            <div class="name_label"><span id="nname">ì´ë¦„</span>
                <input type="text" name="input_username" id="username" onkeyup="chkChar(this)" minlength="2"
                    maxlength="4" size="40" required oninput="setCustomValidity('')" />
            </div>
            <span id="bbirthday">ìƒë…„ì›”ì¼<br></span>
            <div class="birth">
                <select id="select_year" onchange="javascript:lastdayNew();">
                    <option value="yyyy" selected>ì—°ë„</option>
                </select>

                <select id="select_month" onchange="javascript:lastdayNew();">
                    <option value="mm" selected>ì›”</option>
                </select>

                <select id="select_day">
                    <option value="dd" selected>ì¼</option>
                    <option value="1">1</option>
                </select>

                <!-- ì–‘ë ¥ìŒë ¥ -->
                <select id="date_type">
                    <option value="ì–‘ë ¥" selected>ì–‘ë ¥</option>
                    <option value="ìŒë ¥">ìŒë ¥</option>
                </select>
            </div>




            <!-- í•˜ë‹¨ ì˜ì—­ -->
            <div class="flexbox_bottom">
                <div class="item4">ì‚¬ìš©ìì˜ ê°œì¸ì •ë³´ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ìš©ë„ë¡œë§Œ ì‚¬ìš©ë©ë‹ˆë‹¤.<br>
                    ë”°ë¡œ ì €ì¥ë˜ê±°ë‚˜ ìœ ì¶œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
                </div>
                <input type="button" value="ì‹œì‘í•˜ê¸°" onclick="check_onclick()"
                    formaction="https://psychologicaltest.pythonanywhere.com/v1/result?date_type=date_type&name=username&year=select_year&month=select_month&day=select_day">

            </div>
        </form>
        <div class="input_share">í…ŒìŠ¤íŠ¸ ê³µìœ í•˜ê¸°
        </div>
        <div class="input_shareitem">
            <a href="javascript:sendLink()" id="kakao-link-btn" class="kakao"><img src="image/kakao.png"
                    alt="kakao_connect" id="kakao"></a>
            <a href="javascript:shareTwitter();" target="_self"><img src="image/twiter.png" alt="twt_connect" id="twt"></a>
            <a href="javascript:copyToClipboard(val)" id="textarea" onclick="copy()" target="_self">
                <img src="image/url2.png" alt="url_connect" id="urll"></a>
            <script src="./share.js"></script>
        </div>

    </div>
    <div class="input_footerpc">
        Copyright â’¸ Meet eum - Sonã…£ Won seok - An ã…£ Tae gon - Kim . All rights reserved.
    </div>
    <div class="input_footermobile">
        Copyright â’¸ Meet eum - Sonã…£ Won seok - Anã…£<br> Tae gon - Kim ã…£ All rights reserved.
    </div>

    <script>
        //ì´ë¦„ ì…ë ¥ì— íŠ¹ë¬¸ ì œê±° function
        function chkChar(obj) {
            let RegExp = /[\{\}\[\]\/?.,;:|\)*~`!^\-_+â”¼<>@\#$%&\'\"\\\(\=]/gi;	//ì •ê·œì‹ êµ¬ë¬¸
            if (RegExp.test(obj.value)) {
                // íŠ¹ìˆ˜ë¬¸ì ëª¨ë‘ ì œê±°
                obj.value = obj.value.replace(RegExp, '');
            }
        }


        //ì‹œì‘í•˜ê¸° ë²„íŠ¼ í´ë¦­ì‹œì— ìœ íš¨ì„±ê²€ì‚¬ function
        function check_onclick() {
            var username = document.getElementById("username").value;
            var select_year = document.getElementById("select_year").value;
            var select_month = document.getElementById("select_month").value;
            var select_day = document.getElementById("select_day").value;

            if (!username) {
                alert("ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                username.focus();
                return false;
            };
            if (select_year == "yyyy" && select_month == "mm" && select_day == "dd") {
                alert("ìƒë…„ì›”ì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");
                return false;
            };
            if (select_year == "yyyy") {
                alert("ì—°ë„ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");
                return false;
            }
            if (select_month == "mm") {
                alert("ì›”ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return false;
            }
            if (select_day == "dd") {
                alert("ì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");
                return false;
            };


            var userAction = async () => {
                const username = document.getElementById("username").value;
                const select_year = document.getElementById("select_year").value;
                const select_month = document.getElementById("select_month").value;
                const select_day = document.getElementById("select_day").value;
                const date_type = document.getElementById("date_type").value;


                const response = await fetch("https://psychologicaltest.pythonanywhere.com/v1/result?" +
                    "date_type=" + date_type + "&name=" + username + "&year=" + select_year + "&month=" + select_month + "&day=" + select_day);
                //http://psychologicaltest.pythonanywhere.com/v1/result?date_type=date_type&name=username&year=select_year&month=select_month&day=select_day
                const result = await response.json();
                let result_key = result["result_key"];
                let name = result['name']
                console.log(result_key)
                const htmlObject = {
                    "ê°‘": "./output_tree.html",
                    "ì„": "./output_weed.html",
                    "ë³‘": "./output_sun.html",
                    "ì •": "./output_moon.html",
                    "ë¬´": "./output_mountain.html",
                    "ê¸°": "./output_land.html",
                    "ê²½": "./output_rock.html",
                    "ì‹ ": "./output_jewelry.html",
                    "ì„": "./output1.html",
                    "ê³„": "./output_rain.html"
                }
                window.location.href = htmlObject[result_key] + "?name=" + username;
            }

            userAction();
        }





        var start_year = "1960";// ì‹œì‘í•  ë…„ë„ 
        var today = new Date();
        var today_year = 2049;
        var index = 1;
        for (var y = start_year; y <= today_year; y++) { //start_year ~ 2049 ë…„ë„ 
            document.getElementById('select_year').options[index] = new Option(y, y);
            index++;
        }
        index = 1;
        for (var m = 1; m <= 12; m++) {
            document.getElementById('select_month').options[index] = new Option(m, m);
            index++;
        }


        //ì—°ë„, ì›” ì„ íƒ í›„ ìœ¤ë…„ êµ¬í˜„ fucntion
        function lastdayNew() {
            const year = document.getElementById("select_year").value;
            const month = document.getElementById("select_month").value;
            const day = new Date(new Date(year, month, 1) - 86400000).getDate();
            if (!(year > 0 && month > 0)) {
                console.log(true);
                return;
            }


            const daySelect = document.getElementById("select_day");

            daySelect.options.length = 0;
            for (let i = 1; i <= day; i++) {
                let option = document.createElement("option");
                option.text = i;
                option.value = i;
                daySelect.append(option);
            }
        }
        // async function fn_count() { //ì¿¼ë¦¬ìŠ¤íŠ¸ë§ ì‚¬ìš©ìì—ê²Œ ë°›ì€ ê°’ì„ ê°€ê³µ í›„ì— ë‹¤ì‹œ ì¶œë ¥ì‹œí‚¤ê¸° ìœ„í•´ í•„ìš”.
        //     const response = await fn_fetch('http://psychologicaltest.pythonanywhere.com/v1/count', 'GET');
        //     const result = await response.json();
        //     console.log(result)
        //     document.getElementById("api-count").innerText = result
        // }
        // async function fn_fetch(url, method, data) {
        //     try {
        //         const response = await fetch(url, {//ì¿¼ë¦¬ìŠ¤íŠ¸ë§ ì‚¬ìš©ìì—ê²Œ ë°›ì€ ê°’ì„ ê°€ê³µ í›„ì— ë‹¤ì‹œ ì¶œë ¥ì‹œí‚¤ê¸° ìœ„í•´ í•„ìš”.
        //             method: method ? method : "GET",
        //             headers: {
        //                 "Content-Type": "application/json;charset=utf-8",
        //             },
        //             body: JSON.stringify(data),
        //         });
        //         if (response.ok) {
        //             return await response;
        //         }
        //         throw new Error();
        //     } catch (e) {
        //         console.log("error : " + e);
        //     }
        // }
        //í´ë¦½ë³´ë“œ url ë³µì‚¬
        function copyToClipboard(val) {
            const t = document.createElement("textarea");
            document.body.appendChild(t);
            t.value = val;
            t.select();
            document.execCommand('copy');
            document.body.removeChild(t);
        }
        function copy() {
            copyToClipboard('https://earlyway.github.io/');
            console.log('Copied!');
            alert("url ì£¼ì†Œ ë³µì‚¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ì›í•˜ëŠ” ê³³ì— ê³µìœ í•´ë³´ì„¸ìš” ğŸ™‚")
        }

        //twitter ê³µìœ ê¸°ëŠ¥
        function shareTwitter() {
            var sendText = "ë‚˜ì˜ íƒ€ê³ ë‚œ ìì—°ì˜ ëª¨ìŠµì€? í…ŒìŠ¤íŠ¸ í•˜ëŸ¬ê°€ê¸°"; // ì „ë‹¬í•  í…ìŠ¤íŠ¸
            var sendUrl = "https://earlyway.github.io/"; // ì „ë‹¬í•  URL
            window.open("https://twitter.com/intent/tweet?text=" + sendText + "&url=" + sendUrl);
        }

        var countAction = async () => {
            const response = await fetch('http://psychologicaltest.pythonanywhere.com/v1/count');
            const result = await response.json();
            document.getElementById("api-count").innerText = result["count"]
        }
        countAction();
    </script>
</body>

</html>